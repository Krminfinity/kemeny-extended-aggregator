# 拡張ケメニー則における前提・制約条件

## 1. 基本的な前提条件

### 1.1 参加者に関する前提
- **有限の参加者数**: エージェント数 n は有限
- **完全情報**: すべての参加者の選好順序が既知
- **戦略的行動なし**: 参加者は正直に選好を申告（戦略的操作を考慮しない）

### 1.2 選択肢に関する前提
- **有限の選択肢数**: 代替案の数 m は有限
- **選択肢の同一性**: すべての参加者が同じ選択肢集合を評価

## 2. 選好構造に関する制約

### 2.1 選好順序の特性
- **完全順序**: 各参加者の選好は完全順序である
- **推移性**: 選好関係は推移的である（a ≻ b かつ b ≻ c なら a ≻ c）
- **非循環性**: 選好には循環がない

### 2.2 順序関係の表現
- **順序のみ**: 選好の強度や効用値は考慮しない
- **序数的選好**: 基数的効用ではなく序数的順序のみを使用

## 3. アルゴリズム固有の制約

### 3.1 ケメニー距離に関する制約
- **対称性**: d(σ, π) = d(π, σ)
- **非負性**: すべての距離は非負の値
- **三角不等式**: d(σ, τ) ≤ d(σ, π) + d(π, τ)

### 3.2 拡張ケメニー則の制約
- **適応性**: フィット度に基づく順位調整が可能
- **単調性**: より良いフィット度を持つ代替案は優遇される

## 4. フィット度（適応度）に関する制約

### 4.1 理論的制約
- **非負性**: フィット度は非負の値（fitness ≥ 0）
- **整数性（暗黙的仮定）**: 理論的記述では整数として扱われる
- **相対的評価**: フィット度の相対的な大小関係が重要

### 4.2 実装上の制約
- **実数許容**: 実装では実数値のフィット度も処理可能
- **数値安定性**: 浮動小数点演算の精度制限

## 5. 最適化に関する制約

### 5.1 計算複雑性
- **NP困難性**: ケメニー最適解の計算はNP困難
- **近似解の許容**: 実用的な時間内での近似解を受け入れる

### 5.2 収束性
- **有限ステップ**: アルゴリズムは有限ステップで終了
- **局所最適解**: グローバル最適解の保証はない

## 6. DA（Deferred Acceptance）アルゴリズムとの統合制約

### 6.1 マッチング制約
- **安定性**: マッチング結果の安定性を保持
- **戦略耐性**: 虚偽申告に対する耐性

### 6.2 互換性制約
- **順序の一貫性**: 拡張ケメニー則の結果とDAアルゴリズムの入力の整合性
- **効率性**: 計算効率の維持

## 7. データ構造に関する制約

### 7.1 入力データの形式
- **行列形式**: 選好順序は行列として表現
- **インデックス**: 0ベースまたは1ベースのインデックス統一

### 7.2 出力データの形式
- **順序リスト**: 結果は順序付きリストとして出力
- **スコア付き**: 各代替案にスコアを付与

## 8. 実装上の技術的制約

### 8.1 メモリ制約
- **メモリ効率**: 大規模データに対するメモリ使用量の制限
- **スケーラビリティ**: 参加者数・選択肢数の増加への対応

### 8.2 精度制約
- **数値精度**: 浮動小数点演算の精度限界
- **丸め誤差**: 計算過程での丸め誤差の蓄積

## 9. 応用領域固有の制約

### 9.1 マッチングシステムでの制約
- **容量制約**: 各選択肢の受け入れ可能数の上限
- **適格性制約**: 参加者と選択肢の適格性要件

### 9.2 評価システムでの制約
- **公平性**: すべての参加者に対する公平な扱い
- **透明性**: アルゴリズムの動作の説明可能性

## 10. 暗黙的制約・仮定

### 10.1 環境的制約
- **静的環境**: 計算中に選好や条件が変化しない
- **情報完全性**: 必要なすべての情報が利用可能

### 10.2 理論的仮定
- **合理性**: 参加者は合理的に行動する
- **独立性**: 各参加者の選好は他者の選好に依存しない

## 11. 実装上の厳格な制約（2025年9月追加）

### 11.1 参加者数の制限
- **被介護者数の上限**: 計算量を考慮し、最大100人まで
- **ケアワーカー数の上限**: 計算量を考慮し、最大100人まで
- **計算複雑性の管理**: O(n²) または O(n³) の計算が現実的な時間で完了する範囲

### 11.2 フィット度の厳格な制約
- **整数限定**: フィット度は厳密に整数値のみ許可（実数値は拒否）
- **単射性**: 同一人物のフィット度に重複値は存在しない
- **一意性保証**: すべてのフィット度は互いに異なる値を持つ

### 11.3 データ検証の強化
- **入力時検証**: すべての入力データが制約を満たすことを事前チェック
- **エラー処理**: 制約違反時は明確なエラーメッセージを出力
- **型安全性**: 整数以外のフィット度入力は実行時エラーとして処理

---

**注記**: これらの制約条件は、拡張ケメニー則の理論的基盤と実装の両方から導出されています。2025年9月の更新により、実装の複雑化を防ぐための厳格な制約が追加されました。